## PA2 REPORT

### 1、Bezier曲线和B样条曲线比较

#### 相同点

- 两者都是多项式参数曲线
- 两者都可以用De Boor算法计算，因为Bezier曲线是B样条曲线的特例

#### 不同点

- Bezier曲线不能通过改变个别的控制顶点来进行局部修改（因为曲线上每个点都受到每个控制顶点影响），但是B样条曲线可以
- B样条曲线可以拼接，而且拼接处连续性好，但Bezier曲线拼接时拼接处连续性难以满足
- B样条曲线的曲线次数和控制顶点个数无关，因此可以设置多个控制顶点而无需担心计算量的问题

### 2、绘制“首尾相接且接点处也有连续性质的B样条曲线”方法

（理解为“绘制的曲线整体为一个闭环”）

- 方法：前k个控制顶点（$P_0$...$P_{k-1}$），在控制顶点序列的末尾再添加 $P_0$ $P_1$ ... $P_{k-2}$ $P_{k-1}$
- 原因：因为区间[$t_i$, $t_{i+1}$]中的点只受到$P_{i-k}$...$P_i$的控制（共k+1个点），区间[$t_{i+1}$, $t_{i+2}$]中的点只受到$P_{i+1-k}$...$P_{i+1}$的控制，两个区间首尾平滑连接，连接处曲线连续，即：第一个区间的控制点中后k个点，与第二个区间控制点中前k个点相同，则可以平滑连接，因此在控制顶点序列末尾，再添加首部相同的k个点

（理解为“区间[$t_i$, $t_{i+1}$]中曲线尾部与区间[$t_{i+1}$, $t_{i+2}$]中曲线首部平滑连接”）

- 方法：由De Boor-Cox递推方法（即$B_{i, k}$由$B_{i, k-1}$和$B_{i+1, k-1}$加权求和），可以绘制“首尾相接且接点处也有连续性质的B样条曲线”

### 3、revsurface.hpp代码逻辑

- 首先得到表示一个曲线的顶点、切向列表
- 对于旋转，指定旋转步数step（每次旋转$2\pi/step$度）
- 由旋转度数计算得到旋转矩阵，用矩阵点乘原有的顶点坐标、切向，得到旋转后的顶点坐标、切向
- “列表中本顶点、列表中下一个顶点、本顶点旋转后的点、列表中下一个顶点旋转后的点”共面，形成四边形，按对角线剖分为三角形，将三角面片存储，汇总即得到旋转曲面

### 4、中途遇到的问题以及解决方法

- resolution：最开始对Bezier的resolution有误，文档修改后，我改写为双重循环，保证每两个knot之间都是resolution这么多段
- 在group中添加drawGL：否则全黑，无法渲染
- data中数据顺序：阅读revsurface.hpp后我意识到data中点的存储顺序，关系到“曲面上四边形的切分方式”（data中点全部倒序，则四边形切分为三角形时，对角线的方向将会改变，存储的三角面片也会不同），因此交了很多次OJ之后，我修改了data中数据存储顺序，最后通过（个人建议，感觉这里是不是可以改进一下OJ？）

### 5、致谢、借鉴与参考

- 感谢老师、助教提供本次练习机会，这次编程我感觉大大加深我对B样条曲线和Bezier曲线的理解，很有收获！
- B样条的De Boor方法，参考了作业提供的basis.py改写
- 与计23班万子豪同学讨论了data顺序问题
